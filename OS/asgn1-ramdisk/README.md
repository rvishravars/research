# Requirement

1. Implement a virtual ramdisk as a character device based on the template module provided in the Resources area.  
2. Support writing to and reading from the device using:
   - `ls > /dev/asgn1`
   - `cat /dev/asgn1`  
3. Allow writing files of unlimited size (bounded only by available system memory).  
4. Allocate new memory pages using `alloc_page()` whenever more memory is needed.  
5. Link allocated pages using a doubly linked list so the total number of pages is unbounded.  
6. Use kernel list utilities to manage the list (e.g., `LIST_HEAD`, `list_add`, `list_del`, `list_entry`, `list_empty`).  
7. When the device is opened in write-only mode, remove the page list and free all previously allocated pages.  
8. Support seeking within the device.  
9. Control the maximum number of concurrent users (processes) via `ioctl()`.  
10. If more than the maximum number of processes attempt access, `open()` must deny access or block the caller until an existing process finishes.  
11. Ensure all allocated memory is freed when the module is unloaded.  
12. Use `udev` (as in the template) to automatically create/destroy the device node; the node name is `asgn1`.  
13. After loading the module, change the `asgn1` nodeâ€™s permissions to allow everyone read and write access.
14. mmap implementation

# Project Files

-   `asgn1_skel.c`: The core of the project, this is the kernel module source code that implements the virtual ramdisk character device.
-   `mmap_test.c`: A user-space C program designed to test the functionality of the `/dev/asgn1` device, including `write`, `read`, `mmap`, and `ioctl` system calls.
-   `mmap_test_shell.sh`: A helper shell script that automates the entire process of testing the kernel module. It handles loading the module, creating the device node, running the test program, and cleaning up.
-   `Makefile`: A makefile to compile the kernel module (`asgn1.ko`) and the user-space test program (`mmap_test`).

# How to Build and Run

## 1. Prerequisites

```bash
sudo apt-get update
sudo apt-get install linux-headers-$(uname -r)
```

## 2. Compilation

Can build the module and the test program by running the `make` command:

```bash
make
```

This will generate the kernel module `asgn1.ko` and the test executable `mmap_test`.

## 3. Running the mmap Test

The `mmap_test_shell.sh` script automates the testing procedure. It requires root privileges to load/unload kernel modules and create device nodes.

Execute the script with `sudo`:

```bash
sudo ./mmap_test_shell.sh
```

The script will:
1.  Load the `asgn1.ko` module into the kernel.
2.  Create the device node at `/dev/asgn1`.
3.  Run the `mmap_test` executable to perform tests on the device.
4.  Remove the device node.
5.  Unload the `asgn1.ko` module.

Can view the kernel logs generated by the module by running `dmesg`.
